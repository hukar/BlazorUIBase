@page "/modify/{RobotId:int}"
@using System.Text.Json



<MudText Class="my-6" Typo="Typo.h3" Color="Color.Secondary">RobotForm : Modify Mode</MudText>

<MainForm Robot="_robot" IsValid="ModifyRobot" LabelSubmitButton="Modify Robot" />



@code {
    [Inject] private IRobotRepository? Repo { get; set;  }

    [Inject]
    private NavigationManager NavigationManager { get; set; } = default!;

    [Parameter] public int RobotId { get; set; }

    private Robot? _robot = new();

    protected override async Task OnInitializedAsync()
    {
        _robot = await Repo!.GetRobotWithWeapons(RobotId);

        
        if (_robot is null)
        {
            Console.WriteLine("Robot doesn't exist, go to create it");
            NavigationManager.NavigateTo("/robot/add");
        }
    }

    private void ModifyRobot()
    {
        var robotStr = JsonSerializer.Serialize(_robot, new JsonSerializerOptions()
        {
            WriteIndented = true
        });
        Console.WriteLine("Robot is Modified");
        Console.WriteLine(robotStr);
        NavigationManager.NavigateTo("/robot/list");
    }
}